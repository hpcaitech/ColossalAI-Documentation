<!doctype html>
<html class="docs-version-v0.2.2" lang="zh-Hans" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/zh-Hans/blog/rss.xml" title="Colossal-AI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-Hans/blog/atom.xml" title="Colossal-AI Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1XKZVCCKRZ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1XKZVCCKRZ",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Colossal-AI" href="/zh-Hans/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script src="https://snack.expo.io/embed.js" async></script>
<script src="https://js-eu1.hs-scripts.com/26563514.js" async defer="defer" id="hs-script-loader"></script><title data-react-helmet="true">ä½¿ç”¨ColoTensorè®©ä¸²è¡Œç¨‹åºåƒMegatron-LMä¸€æ ·å¹¶è¡Œ | Colossal-AI</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://colossalai.org/zh-Hans/docs/advanced_tutorials/parallelize_your_training_like_Megatron"><meta data-react-helmet="true" name="docsearch:language" content="zh-Hans"><meta data-react-helmet="true" name="docsearch:version" content="v0.2.2"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-v0.2.2"><meta data-react-helmet="true" property="og:title" content="ä½¿ç”¨ColoTensorè®©ä¸²è¡Œç¨‹åºåƒMegatron-LMä¸€æ ·å¹¶è¡Œ | Colossal-AI"><meta data-react-helmet="true" name="description" content="Author: Haichen Huang and Jiarui Fang"><meta data-react-helmet="true" property="og:description" content="Author: Haichen Huang and Jiarui Fang"><link data-react-helmet="true" rel="icon" href="/zh-Hans/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://colossalai.org/zh-Hans/docs/advanced_tutorials/parallelize_your_training_like_Megatron"><link data-react-helmet="true" rel="alternate" href="https://colossalai.org/docs/advanced_tutorials/parallelize_your_training_like_Megatron" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://colossalai.org/zh-Hans/docs/advanced_tutorials/parallelize_your_training_like_Megatron" hreflang="zh-Hans"><link data-react-helmet="true" rel="alternate" href="https://colossalai.org/docs/advanced_tutorials/parallelize_your_training_like_Megatron" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://XP2V2KAOVI-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh-Hans/assets/css/styles.b5c97f7b.css">
<link rel="preload" href="/zh-Hans/assets/js/runtime~main.aab5813c.js" as="script">
<link rel="preload" href="/zh-Hans/assets/js/main.255c5581.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet"><div class="Toastify"></div><div><a href="#" class="skipToContent_1oUP">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner InnerContainer_1wkI"><div class="navbar__items"><a class="navbar__brand" href="/zh-Hans/"><div class="navbar__logo"><img src="/zh-Hans/img/logo.svg" alt="Colossal-AI" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/zh-Hans/img/logo.svg" alt="Colossal-AI" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title"> </b></a><a class="navbar__item navbar__link" href="/zh-Hans/docs/get_started/installation">æ•™ç¨‹</a><a href="https://github.com/hpcaitech/ColossalAI/tree/main/examples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ä¾‹å­</a><a href="http://docs.colossalai.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">APIæ–‡æ¡£</a><a href="https://www.hpc-ai.tech/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">åšå®¢</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-Hans/docs/advanced_tutorials/add_your_parallel">v0.2.2</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/advanced_tutorials/parallelize_your_training_like_Megatron" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh-Hans/docs/advanced_tutorials/parallelize_your_training_like_Megatron" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="displayOnlyInLargeViewport_2uzv IconContainer_aWwG"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="Icon_3e04" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></div><div class="toggle_71bT toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="searchBox_1ZXk"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="Wrapper_ReNv main-docs-wrapper"><div class="docPage_3AUJ"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><main class="docMainContainer_2AUC"><div class="padding-vert--lg container docItemWrapper_1WZa"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>ä½¿ç”¨ColoTensorè®©ä¸²è¡Œç¨‹åºåƒMegatron-LMä¸€æ ·å¹¶è¡Œ</h1></header><p>Author: <a href="https://github.com/1SAA" target="_blank" rel="noopener noreferrer">Haichen Huang</a> and <a href="https://github.com/feifeibear" target="_blank" rel="noopener noreferrer">Jiarui Fang</a></p><p><strong>Prerequisite:</strong></p><ul><li><a href="/zh-Hans/docs/basics/colotensor_concept">ColoTensor Concepts</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ä»‹ç»">ä»‹ç»<a class="hash-link" href="#ä»‹ç»" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>åœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†ColoTensorã€‚ColoTensorä¸ºç”¨æˆ·ä½¿ç”¨å¹¶è¡Œè®­ç»ƒæä¾›äº†æå¤§çš„ä¾¿åˆ©ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨åŸæœ¬çš„ä¸²è¡Œä»£ç ä¸Šï¼Œé€šè¿‡è¾ƒå°çš„ä¿®æ”¹å°†è®­ç»ƒæ”¹ä¸ºå¹¶è¡Œã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è¯´æ˜å¦‚ä½•ä¿®æ”¹è®­ç»ƒæ¨¡å‹ä»¥è‡ªåŠ¨ä½¿ä»£ç é‡‡å–åƒ Megatron-LM ä¸€æ ·çš„æ–¹å¼å¹¶è¡Œè®­ç»ƒã€‚æˆ‘ä»¬ä»¥ HuggingFace æä¾›çš„ GPT-2 æ¨¡å‹ä¸ºä¾‹ï¼Œå¹¶æä¾›ä¸€ç§æ–¹å¼è®©ä½ å¯ä»¥åœ¨å•ä¸ªGPUä¸Šé¢„è®­ç»ƒGPT-2æ¨¡å‹ã€‚</p><p>Megatron-LM æä¾›äº†ä¸€ä¸ªå…·æœ‰å½±å“åŠ›çš„å¹¶è¡ŒåŒ–èŒƒå¼ï¼Œè¿™ä¸ªèŒƒå¼ä¸»è¦åº”ç”¨äºTransformerå¤§æ¨¡å‹çš„è®­ç»ƒã€‚ç„¶è€Œï¼Œä¸ºäº†å¤§è§„æ¨¡è®­ç»ƒ Transformer è¯­è¨€å¤§æ¨¡å‹ï¼Œç”¨æˆ·å¿…é¡»ä½¿ç”¨Megatron-LMæä¾›çš„ç‰¹æ®Šæ¨¡å—æ¥æ„å»ºä»–ä»¬çš„æ¨¡å‹ã€‚è¿™ç»™ç”¨æˆ·å¸¦æ¥äº†ä¸€äº›å›°éš¾çš„å·¥ä½œï¼Œä¾‹å¦‚ä»é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹ä¸­åŠ è½½æƒé‡ï¼Œæˆ–æ˜¯æ„å»ºè‡ªå·±çš„å¹¶è¡Œè®­ç»ƒæ¨¡å‹ã€‚ä¸ºäº†å‡è½»ç”¨æˆ·çš„éº»çƒ¦ï¼Œæˆ‘ä»¬æä¾› ColoTensor ç±»ï¼Œä»¥å®Œæˆè‡ªåŠ¨å¯ç”¨å¼ é‡æ¨¡å‹å¹¶è¡Œã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="å®šä¹‰æ¨¡å‹å’ŒæŸå¤±å‡½æ•°">å®šä¹‰æ¨¡å‹å’ŒæŸå¤±å‡½æ•°<a class="hash-link" href="#å®šä¹‰æ¨¡å‹å’ŒæŸå¤±å‡½æ•°" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨ HuggingFace åº“ä¸­çš„ GPTModel å’Œ GPTLossã€‚</p><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> nn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> transformers </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GPT2Config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GPT2LMHeadModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">GPTLMModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hidden_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">768</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_layers</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_attention_heads</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max_seq_len</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vocab_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">50257</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> checkpoint</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">checkpoint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> checkpoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GPT2LMHeadModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GPT2Config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_embd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hidden_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_layer</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">num_layers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     n_head</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">num_attention_heads</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_positions</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">max_seq_len</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_ctx</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">max_seq_len</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vocab_size</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">vocab_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> checkpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gradient_checkpointing_enable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_ids</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> attention_mask</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Only return lm_logits</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input_ids</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">input_ids</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> attention_mask</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">attention_mask</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use_cache</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">checkpoint</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">GPTLMLoss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loss_fn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CrossEntropyLoss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> logits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shift_logits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> logits</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">contiguous</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shift_labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">contiguous</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Flatten the tokens</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loss_fn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shift_logits</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shift_logits</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shift_labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="å¯¹gpt-2çš„ç®€çŸ­å›é¡¾">å¯¹GPT-2çš„ç®€çŸ­å›é¡¾<a class="hash-link" href="#å¯¹gpt-2çš„ç®€çŸ­å›é¡¾" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ç°åœ¨ï¼Œæˆ‘ä»¬å›é¡¾ä¸€ä¸‹ GPT-2 æ¨¡å‹çš„ç»“æ„ã€‚æ¯ä¸ª GPT-2 æ¨¡å‹éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª DAGã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªåœ†åœˆä»£è¡¨ä¸€ä¸ªç®—å­ï¼Œæ¯ä¸ªæ–¹å—ä»£è¡¨ä¸€ä¸ªæƒé‡ã€‚æ¯ä¸ªç®­å¤´è¡¨ç¤ºè¾“å…¥æ•°æ®çš„æµå‘ï¼Œè€Œç®­å¤´æ—è¾¹çš„ç¬¦å·è¡¨ç¤ºè¾“å…¥æ•°æ®çš„å½¢çŠ¶ã€‚</p><p>ç„¶åï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹è¿™ä¸ª GPT-2 æ¨¡å‹ã€‚å®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯<strong>åµŒå…¥æ¨¡å—</strong>ã€<strong>è½¬æ¢å™¨å±‚</strong>å’Œ<strong>åˆ†ç±»å¤´</strong>ã€‚</p><p>åµŒå…¥æ¨¡å—åŒ…å«ä¸¤ä¸ªæƒé‡ï¼Œç¬¦å·åµŒå…¥æƒé‡å’Œä½ç½®åµŒå…¥æƒé‡ã€‚åœ¨åµŒå…¥æ¨¡å—çš„å‰å‘æ“ä½œä¹‹åï¼ŒåŸå§‹è¾“å…¥æ•°æ®çš„æ‰€æœ‰åºåˆ—ä¸­çš„æ¯ä¸ªå•è¯éƒ½ä¼šè¢«åµŒå…¥åˆ°éšè—çŠ¶æ€ã€‚</p><figure style="text-align:center"><img src="https://s2.loli.net/2022/08/17/omfkIEN6ui5jcL3.png"><figcaption>åµŒå…¥æ¨¡å—</figcaption></figure><p>æ¯ä¸ªè½¬æ¢å™¨å±‚åŒ…å«ä¸¤ä¸ªå—ã€‚è‡ªæ³¨æ„æ“ä½œåœ¨ç¬¬ä¸€ä¸ªå—ä¸­è°ƒç”¨ï¼ŒåŒæ—¶ä¸€ä¸ªåŒå±‚æ„ŸçŸ¥å™¨ä½äºç¬¬äºŒä¸ªå—ä¸­ã€‚</p><figure style="text-align:center"><img src="https://s2.loli.net/2022/08/17/LAVzDlpRcj4dYeb.png"><figcaption>è½¬æ¢å™¨å±‚</figcaption></figure><p>æœ€åï¼Œåˆ†ç±»å¤´åªæ˜¯ä¸€ä¸ªä¸åŠ åå·®çš„çº¿æ€§æ¨¡å—ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ªçº¿æ€§æƒé‡ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="åº”ç”¨colotensor">åº”ç”¨ColoTensor<a class="hash-link" href="#åº”ç”¨colotensor" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä¸¤ä¸ªæ­¥éª¤ä½¿æ‚¨çš„ä¸²è¡Œä»£ç é‡‡å– Megatron-LM å¼ é‡å¹¶è¡Œé£æ ¼ã€‚</p><ol><li>åœ¨ColoInitContextçš„ä¸Šä¸‹æ–‡ä¸­åˆå§‹åŒ–æ¨¡å‹ã€‚</li><li>ä¸ºæ¯ä¸ªå‚æ•°è®¾ç½® ColoTensorSpecã€‚</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ä½¿ç”¨-coloinitcontext-åˆå§‹åŒ–">ä½¿ç”¨ ColoInitContext åˆå§‹åŒ–<a class="hash-link" href="#ä½¿ç”¨-coloinitcontext-åˆå§‹åŒ–" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æˆ‘ä»¬åº”è¯¥åœ¨ ColoInitContext ä¸­æ„å»ºæ¨¡å‹ã€‚åœ¨è¯¥ç§ä¸Šä¸‹æ–‡ä¸­ï¼Œä»»ä½•åˆå§‹åŒ–çš„å‚æ•°éƒ½å°†è½¬æ¢ä¸º ColoParameter å¹¶è‡ªåŠ¨ç§»åŠ¨åˆ°ç›¸åº”çš„è®¾å¤‡ä¸Šã€‚</p><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> colossalai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">colo_init_context </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ColoInitContext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> ColoInitContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;cpu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GPTLMModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ä¸ºæ¯ä¸ªå‚æ•°è®¾ç½®-colotensorspec">ä¸ºæ¯ä¸ªå‚æ•°è®¾ç½® ColoTensorSpec<a class="hash-link" href="#ä¸ºæ¯ä¸ªå‚æ•°è®¾ç½®-colotensorspec" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ¨¡å‹åˆ›å»ºå®Œæˆåï¼Œæˆ‘ä»¬é€šè¿‡ProcessGroupå»ºç«‹åˆ†å¸ƒå¼ç¯å¢ƒã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†å¼ é‡å¹¶è¡Œåº¦æŒ‡å®šä¸ºæ‰€æœ‰GPUçš„æ•°é‡ï¼Œå³æ•°æ®å¹¶è¡Œåº¦ä¸ºä¸€ã€‚</p><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">distributed </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> dist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> colossalai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ProcessGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ProcessGroup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tp_degree</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dist</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_world_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›è¾…åŠ©å‡½æ•°ä¸ºä¸‹ä¸€æ­¥åšå‡†å¤‡ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°æ¥åˆ‡åˆ†å‚æ•°ã€‚Megatron-LMå¼ é‡å¹¶è¡Œéœ€è¦æ²¿å‚æ•°çš„ç¬¬ä¸€ç»´æˆ–æœ€åä¸€ç»´åˆ‡åˆ†å‚æ•°å¼ é‡ã€‚</p><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> colossalai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ShardSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ComputeSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ComputePattern</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ColoParameter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ProcessGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">split_param_single_dim_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ColoParameter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ProcessGroup</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ShardSpec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tp_world_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ComputeSpec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ComputePattern</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TP1D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process_group</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tp_world_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_process_group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_tensor_spec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">spec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">split_param_row_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ColoParameter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ProcessGroup</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    split_param_single_dim_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">split_param_col_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ColoParameter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ProcessGroup</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    split_param_single_dim_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç„¶åæˆ‘ä»¬ä½¿æ¨¡å‹é‡‡ç”¨å¼ é‡å¹¶è¡Œã€‚æ ¹æ® Megatron ä¸­ä½¿ç”¨çš„å¼ é‡å¹¶è¡Œï¼Œåº”è¯¥æ²¿ç€å¼ é‡çš„æœ€åä¸€ä¸ªç»´åº¦è¿›è¡Œåˆ‡ç‰‡ï¼ŒåŒ…æ‹¬ç¬¦å·åµŒå…¥çš„æƒé‡ï¼Œä½ç½®åµŒå…¥çš„æƒé‡ï¼Œè‡ªæ³¨æ„åŠ›å—ä¸­çš„æ‰€æœ‰çº¿æ€§æƒé‡å’Œåå·®ï¼Œä»¥åŠæ¯ä¸ªåŒå±‚æ„ŸçŸ¥å™¨ä¸­çš„ç¬¬ä¸€ä¸ªçº¿æ€§æƒé‡å’Œåå·®ã€‚ä¸”éœ€è¦æ²¿ç¬¬ä¸€ä¸ªç»´åº¦åˆ‡åˆ†åŒå±‚æ„ŸçŸ¥å™¨ä¸­çš„ç¬¬äºŒä¸ªçº¿æ€§æƒé‡ã€‚</p><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> mn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> module </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">named_modules</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> pn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">named_parameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">recurse</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># set process group for all parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_process_group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mlp.c_fc&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> mn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;weight&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pn </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bias&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                split_param_col_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># colmn slice</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># keep the shape of the output from c_fc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_output_replicate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mlp.c_proj&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> mn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;weight&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                split_param_row_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># row slice</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;wte&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> mn </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;wpe&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> mn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            split_param_col_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># colmn slice</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;c_attn&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> mn </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;c_proj&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> mn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            split_param_col_tp1d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># colmn slice</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¿®æ”¹åçš„æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p>åµŒå…¥æ¨¡å—:</p><figure style="text-align:center"><img src="https://s2.loli.net/2022/08/17/Yu2xzXEabHV7pwe.png"><figcaption>ä¿®æ”¹åçš„åµŒå…¥æ¨¡å—</figcaption></figure><p>è½¬æ¢å™¨å±‚:</p><figure style="text-align:center"><img src="https://s2.loli.net/2022/08/17/4HWsA2xz51IhPFO.png"><figcaption>ä¿®æ”¹åçš„è½¬æ¢å™¨å±‚</figcaption></figure><p>ä¸€æ—¦ç”¨æˆ·æŒ‡å®šäº†æ¯ä¸ªå‚æ•°çš„åœ¨å¹¶è¡Œä¸­çš„åˆ†å¸ƒæ¨¡å¼ï¼ŒColoTensor å°±èƒ½å¤Ÿæ¨æ–­å‡ºæ‰€æœ‰ç®—å­çš„è®¡ç®—æ¨¡å¼ï¼ŒåŒ…æ‹¬çŸ©é˜µä¹˜æ³•ã€çº¿æ€§å‡½æ•°ã€torch.nn.functional ä¸­çš„å…¶ä»–é€å…ƒç´ å‡½æ•°ï¼Œä»¥åŠå…¶ä»–çš„ä¸€äº›å¸¸ç”¨å‡½æ•°ã€‚è¿™æ ·ï¼Œç”¨æˆ·å¯ä»¥åƒå¾€å¸¸ä¸€æ ·è®­ç»ƒä»–ä»¬çš„æ¨¡å‹ã€‚</p><p>åœ¨æˆ‘ä»¬æœ€æ–°ç¤ºä¾‹ä¸­è¿˜å®šä¹‰äº†ä¸€ä¸ªGemini + ZeRO DDP çš„æ¨¡å‹ä»è€Œå‡å°å¼€é”€ï¼Œæå‡æ•ˆç‡ã€‚è¿™ä¸€éƒ¨åˆ†çš„è¯¦ç»†å†…å®¹å¯ä»¥å‚è€ƒ<a href="/zh-Hans/docs/features/zero_with_chunk">ZeRO</a>ï¼Œä½ å¯ä»¥å°†è¿™ä¸¤éƒ¨åˆ†å†…å®¹ç»“åˆèµ·æ¥çœ‹ä»è€Œç†è§£æˆ‘ä»¬æ•´ä¸ªè®­ç»ƒæµç¨‹ï¼š</p><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">gemini_zero_dpp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ProcessGroup</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> placememt_policy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;auto&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> colossalai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parallel </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GeminiDDP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GeminiDDP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">get_current_device</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        placement_policy</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">placememt_policy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        pin_memory</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        search_range_mb</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> model</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="åœ¨å•ä¸ªgpuä¸Šé¢„è®­ç»ƒgpt-2">åœ¨å•ä¸ªGPUä¸Šé¢„è®­ç»ƒGPT-2<a class="hash-link" href="#åœ¨å•ä¸ªgpuä¸Šé¢„è®­ç»ƒgpt-2" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æˆ‘ä»¬åšçš„ä¸Šè¿°ä¼˜åŒ–è®©æˆ‘ä»¬å¯ä»¥åœ¨å•GPUä¸Šè®­ç»ƒGPT-2æ¨¡å‹ï¼Œåªéœ€è¦å°†<code>run.sh</code>ä¸­è®¾ç½®å‚æ•°<code>GPUNUM</code>=1ï¼Œå†è¿è¡Œæ–‡ä»¶æ—¶å°±å¯ä»¥åœ¨å•ä¸ªGPUä¸Šå®Œæˆæ¨¡å‹çš„è®­ç»ƒã€‚</p><p>GPT-2 ç¤ºä¾‹åœ¨<a href="https://github.com/hpcaitech/ColossalAI/tree/main/examples/language/gpt" target="_blank" rel="noopener noreferrer">Train GPT with Colossal-AI</a>. è·å¾—ã€‚</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ä»‹ç»" class="table-of-contents__link toc-highlight">ä»‹ç»</a></li><li><a href="#å®šä¹‰æ¨¡å‹å’ŒæŸå¤±å‡½æ•°" class="table-of-contents__link toc-highlight">å®šä¹‰æ¨¡å‹å’ŒæŸå¤±å‡½æ•°</a></li><li><a href="#å¯¹gpt-2çš„ç®€çŸ­å›é¡¾" class="table-of-contents__link toc-highlight">å¯¹GPT-2çš„ç®€çŸ­å›é¡¾</a></li><li><a href="#åº”ç”¨colotensor" class="table-of-contents__link toc-highlight">åº”ç”¨ColoTensor</a><ul><li><a href="#ä½¿ç”¨-coloinitcontext-åˆå§‹åŒ–" class="table-of-contents__link toc-highlight">ä½¿ç”¨ ColoInitContext åˆå§‹åŒ–</a></li><li><a href="#ä¸ºæ¯ä¸ªå‚æ•°è®¾ç½®-colotensorspec" class="table-of-contents__link toc-highlight">ä¸ºæ¯ä¸ªå‚æ•°è®¾ç½® ColoTensorSpec</a></li></ul></li><li><a href="#åœ¨å•ä¸ªgpuä¸Šé¢„è®­ç»ƒgpt-2" class="table-of-contents__link toc-highlight">åœ¨å•ä¸ªGPUä¸Šé¢„è®­ç»ƒGPT-2</a></li></ul></div></div></div></div></main></div></div><footer class="footer Container_ZO7N"><div class="InnerContainer_kEOB"><div class="ContentContainer_Bd2W"><div class="FooterLeft_UU7Q"><div class="BrandContainer_37NB"><img class="BrandImage_1lbV" alt="AgileTs Logo" height="30" src="/img/logo.svg"></div><div class="Tagline_2AGk">å…·æœ‰é«˜æ•ˆå¹¶è¡ŒåŒ–æŠ€æœ¯çš„é›†æˆå¤§è§„æ¨¡æ¨¡å‹è®­ç»ƒç³»ç»Ÿ</div><button class="ButtonContainer_oPl2 GithubButton_1Y3L"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="GithubIcon_3htU" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><div>GITHUB</div></button></div><div class="FooterRight_1NHD"><div class="SectionContainer_2QT6"><li class="LinkItemTitle_1y09">èµ„æº</li><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="/zh-Hans/docs/get_started/installation" label="æ•™ç¨‹" to="docs/get_started/installation">æ•™ç¨‹</a></ul><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="http://docs.colossalai.org" label="APIæ–‡æ¡£" to="http://docs.colossalai.org">APIæ–‡æ¡£</a></ul><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="https://github.com/hpcaitech/ColossalAI/tree/main/examples" label="ä¾‹å­" to="https://github.com/hpcaitech/ColossalAI/tree/main/examples">ä¾‹å­</a></ul><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="https://github.com/hpcaitech/ColossalAI/discussions" label="è®ºå›" to="https://github.com/hpcaitech/ColossalAI/discussions">è®ºå›</a></ul></div><div class="SectionContainer_2QT6"><li class="LinkItemTitle_1y09">ç¤¾åŒº</li><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="https://github.com/hpcaitech/ColossalAI" rel="noopener noreferrer" target="_blank" label="GitHub">GitHub</a></ul><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="https://www.hpc-ai.tech/blog" rel="noopener noreferrer" target="_blank" label="åšå®¢">åšå®¢</a></ul><ul class="LinkItemContainer_2Lmc"><a class="LinkText_1B0E" href="https://twitter.com/HPCAITech" rel="noopener noreferrer" target="_blank" label="Twitter">Twitter</a></ul></div></div></div><div class="BottomContainer_1let"><div class="CopyrightText_25Fq">Copyright Â© 2023 All Rights Reserved by Luchen Technology Inc.</div></div></div></footer></div>
<script src="/zh-Hans/assets/js/runtime~main.aab5813c.js"></script>
<script src="/zh-Hans/assets/js/main.255c5581.js"></script>
</body>
</html>